name = "lsp"
version = "0.4.0"
executable = "idris2-lsp"

[ source ]
owner = "idris-community"
repo = "idris2-lsp"
rev = "a9458e79a739b108561b50572eae6abe922b519f"
sha256 = "HJp6aHH1w/aN7aaHVQtlq2KLiBUpS3HkFIFuY1/64rU="

[ depends ]
idrisLibs = [ "idris2api" ]
buildInputs = [ ]

[ test ]
enable = true
preTest = """
# macOS does not allow direct access to /tmp
for file in tests/Makefile tests/lsp/message001/*; do
  sed -i "s|/tmp/test-lsp.idr|$(pwd)/tests/test-lsp.idr|g" $file;
done

make -C tests testbin
"""
command = "make -C tests INTERACTIVE= "
